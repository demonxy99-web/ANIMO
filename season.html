<!DOCTYPE html>
<html>
<head>
  <title>Manage Seasons</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body style="background:#0f172a;color:white;padding:16px;font-family:Arial;">

<h2>ğŸ“‚ Seasons</h2>

<input id="seasonName" placeholder="Season 1">
<button onclick="addSeason()">Add Season</button>

<hr>

<div id="seasonList"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import {
  getFirestore, collection, addDoc, getDocs
} from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyDRDsqBFjIXp6mh8LO431Usd-Rmpw5pTDM",
  authDomain: "animo-ab129.firebaseapp.com",
  projectId: "animo-ab129",
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const animeId = localStorage.getItem("animeId");

window.addSeason = async () => {
  if (!seasonName.value) return alert("Enter season name");
  await addDoc(collection(db,"anime",animeId,"seasons"),{
    name: seasonName.value
  });
  seasonName.value="";
  loadSeasons();
};

window.openEpisodes = (seasonId) => {
  localStorage.setItem("seasonId", seasonId);
  location.href = "episode.html";
};

async function loadSeasons(){
  seasonList.innerHTML="";
  const snap = await getDocs(collection(db,"anime",animeId,"seasons"));
  snap.forEach(d=>{
    seasonList.innerHTML+=`
      <div style="margin-top:10px;background:#1e293b;padding:10px;border-radius:6px;">
        <b>${d.data().name}</b><br>
        <button onclick="openEpisodes('${d.id}')">
          ğŸ¬ Manage Episodes
        </button>
      </div>`;
  });
}
loadSeasons();
</script>

</body>
</html>