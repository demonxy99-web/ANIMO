<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ANIMO â€“ Player</title>

<style>
body{margin:0;background:black;color:white;font-family:Arial}
header{padding:10px;background:#0f172a}
video,iframe{width:100%;height:70vh}
</style>
</head>

<body>

<header id="title">Episode</header>

<div id="player"></div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey:"YOUR_API_KEY",
  authDomain:"animo-ab129.firebaseapp.com",
  projectId:"animo-ab129",
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

const video = localStorage.getItem("video");
const title = localStorage.getItem("epTitle");
document.getElementById("title").innerText = title;

/* ðŸŽ¥ VIDEO SOURCES */
const p = document.getElementById("player");

if(video.includes("youtube")){
  p.innerHTML = `<iframe src="${video}" allowfullscreen></iframe>`;
}else{
  p.innerHTML = `<video controls src="${video}"></video>`;
}

/* ðŸ•’ WATCH HISTORY */
const user = auth.currentUser;
if(user){
  await setDoc(doc(db,"users",user.uid,"history",Date.now().toString()),{
    title:title,
    video:video,
    time:new Date()
  });
}
</script>

</body>
</html>